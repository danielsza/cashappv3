import { useState, useRef, useEffect, useCallback } from "react";
import * as XLSX from "xlsx";
import { jsPDF } from "jspdf";
import "jspdf-autotable";

// ─── Settings Persistence ────────────────────────────────────────
const STORAGE_KEY = "gm-parts-receiving-settings";
const SCANS_KEY = "gm-parts-receiving-scans";

function loadSettings() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) return { ...DEFAULTS, ...JSON.parse(raw) };
  } catch (e) {}
  return DEFAULTS;
}
function saveSettingsToStorage(s) {
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); } catch (e) {}
}
function loadScans() {
  try {
    const raw = localStorage.getItem(SCANS_KEY);
    if (raw) return JSON.parse(raw);
  } catch (e) {}
  return [];
}
function saveScans(items) {
  try { localStorage.setItem(SCANS_KEY, JSON.stringify(items)); } catch (e) {}
}

// ─── Constants ───────────────────────────────────────────────────
const KNOWN_DEALERS_DEFAULT = [
  { code: "095207", name: "John Bear Hamilton", contact: "", email: "" },
  { code: "095182", name: "Grimsby Chevrolet", contact: "Christian Ly", email: "cly@grimsbychev.com" },
];

const DEFAULTS = {
  dealerCode: "095207", dealerName: "JOHN BEAR", area: "80", station: "587",
  phone: "905-575-9400", wdkEmail: "wdk.courtesy@gm.com", theme: "light",
  knownDealers: KNOWN_DEALERS_DEFAULT,
};

// ─── Barcode Helpers ─────────────────────────────────────────────
function parseCanadianBarcode(raw, dc) {
  const s = raw.length === 34 ? "0" + raw : raw;
  if (s.length !== 35) return null;
  if (!/^\d+$/.test(s)) return null;
  return { type: "CA", pdc: s.substring(0, 3), shippingOrder: s.substring(3, 10), dealerCode: s.substring(10, 16), partNumber: s.substring(16, 24), serial: s.substring(24), raw, wrongDealer: s.substring(10, 16) !== dc };
}

function parseUSBarcode(combined, dc) {
  if (combined.length < 24) return null;
  return { type: "US", pdc: combined.substring(0, 3), shippingOrder: combined.substring(3, 10), dealerCode: combined.substring(10, 16), partNumber: combined.substring(16, 24), serial: combined.length > 24 ? combined.substring(24) : "", raw: combined, wrongDealer: combined.substring(10, 16) !== dc };
}

function isQuantityScan(val) { const n = parseInt(val, 10); return !isNaN(n) && n >= 2 && n <= 99 && String(n) === val.trim(); }

function classifyScan(val) {
  if (!val || val.length === 0) return "empty";
  if (isQuantityScan(val)) return "quantity";
  if (val.length === 34 || val.length === 35) return "canadian";
  if (val.length === 8 && /^[A-Z0-9]+$/i.test(val)) return "us_part";
  if (val.length >= 10 && val.length <= 18) return "us_header_old";
  if (val.length === 19) return "us_header_new";
  if (val.length === 24) return "us_full";
  if (val.length >= 20 && val.length <= 33) return "incomplete_canadian";
  if (val.length >= 1 && val.length <= 7) return "incomplete_short";
  if (val.length > 35) return "too_long";
  return "unknown";
}

// ─── XLSX / CSV ──────────────────────────────────────────────────
function parseXLSXFile(file) {
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const wb = XLSX.read(e.target.result, { type: "array" });
        resolve(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], { defval: "" }));
      } catch (err) { reject(err); }
    };
    reader.readAsArrayBuffer(file);
  });
}

function parseCSVText(text) {
  const lines = text.trim().split("\n"); if (lines.length < 2) return [];
  const headers = lines[0].split(/[,\t]/).map(h => h.trim().replace(/^"|"$/g, ""));
  return lines.slice(1).map(line => { const vals = line.split(/[,\t]/).map(v => v.trim().replace(/^"|"$/g, "")); const obj = {}; headers.forEach((h, i) => { obj[h] = vals[i] || ""; }); return obj; });
}

function parseFilename(name) {
  const clean = name.replace(/\.[^.]+$/, ""), prefix = "po__control__details_";
  if (!clean.startsWith(prefix)) { const p = clean.split("_").filter(Boolean); return { pbsPO: p[0] || "Unknown", gmControl: p[1] || "", dateStr: "" }; }
  const seg = clean.substring(prefix.length).split("_");
  return { pbsPO: seg[0] || "", gmControl: seg[1] || "", dateStr: seg.slice(2).join("-") || "" };
}

// ─── GM Logo (base64 PNG) ────────────────────────────────────────
const GM_LOGO_B64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABGYAAAClCAYAAAAeevv6AAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAA6/mlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cyk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTctMTAtMjBUMTA6MTY6MjctMDQ6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE3LTEwLTIwVDEwOjE2OjI3LTA0OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNy0xMC0yMFQxMDoxNjoyNy0wNDowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6Y2UzNzNjNzAtMGZmYy05MTQ3LTk2MzUtYjEwMDkwZjEwM2JlPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD5hZG9iZTpkb2NpZDpwaG90b3Nob3A6M2FiZWQ4Y2YtYjVhMS0xMWU3LTk5NDgtYzBmMjJjM2Y3MjgxPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6YzkwMjY5Y2MtZGZmNi02YjQ1LTkyMDUtMTZiM2EzZTJiMDQzPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmM5MDI2OWNjLWRmZjYtNmI0NS05MjA1LTE2YjNhM2UyYjA0Mzwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNy0xMC0yMFQxMDoxNjoyNy0wNDowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpPC9zdEV2dDpzb2Z0d2FyZUFnZW50PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDpjZTM3M2M3MC0wZmZjLTkxNDctOTYzNS1iMTAwOTBmMTAzYmU8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTctMTAtMjBUMTA6MTY6MjctMDQ6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE3IChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNoYW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8cGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPgogICAgICAgICAgICA8cmRmOkJhZz4KICAgICAgICAgICAgICAgPHJkZjpsaT54bXAuZGlkOmU4OWI5ODgyLWU0NWYtNjc0Yi1iNDhmLTY1YTI0NWU5MDRiYjwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpCYWc+CiAgICAgICAgIDwvcGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPgogICAgICAgICA8cGhvdG9zaG9wOkNvbG9yTW9kZT4zPC9waG90b3Nob3A6Q29sb3JNb2RlPgogICAgICAgICA8cGhvdG9zaG9wOklDQ1Byb2ZpbGU+c1JHQiBJRUM2MTk2Ni0yLjE8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3BuZzwvZGM6Zm9ybWF0PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj4zMDAwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj4zMDAwMDAwLzEwMDAwPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjExMjY8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTY1PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4HsrLSAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHUgSURBVHja7H3dkRpJ0/XJjb1/+rVgWQse1gIhC4QsGMaCka6gBRGjiQA1XEmyYEYWCFkg1oJlLVjWgo/Hgvwuuro7s6qaAYafaSbPxmr+obu6KivzVOZJYmYcG4N01GEwAOoQAPeO/yGgnX8fKwL9yyivZQ1gSaD1NBsvYTAYDC8I/XSYANQm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";

// ─── PDF helper: draw underlined text ────────────────────────────
function drawUnderlinedText(doc, text, x, y, opts = {}) {
  const { bold = false, fontSize } = opts;
  if (fontSize) doc.setFontSize(fontSize);
  if (bold) doc.setFont("helvetica", "bold"); else doc.setFont("helvetica", "normal");
  doc.text(text, x, y);
  const tw = doc.getTextWidth(text);
  const sz = doc.getFontSize();
  doc.setLineWidth(0.3);
  doc.line(x, y + sz * 0.01 * 4, x + tw, y + sz * 0.01 * 4);
}

// ─── PDF Generator ───────────────────────────────────────────────
function generateWoodstockPDF({ settings, shortItems, dippItems, dippComments, dippDescriptions = {}, wrongDealerItems, completedBy, formDate, poInfo }) {
  const doc = new jsPDF({ orientation: "portrait", unit: "mm", format: "letter" });
  const pw = doc.internal.pageSize.getWidth();   // 215.9
  const ph = doc.internal.pageSize.getHeight();   // 279.4
  const ml = 12, mr = 12;
  const cw = pw - ml - mr;
  let y = 8;

  // ── Outer border (thick) ──
  doc.setDrawColor(0); doc.setLineWidth(0.8);
  doc.rect(6, 6, pw - 12, ph - 12);

  // ── GM Logo (top-left) ──
  try { doc.addImage(GM_LOGO_B64, "PNG", 9, 9, 45, 7); } catch(e) { /* logo optional */ }

  // ── Header text ──
  y = 12;
  doc.setFontSize(16); doc.setFont("helvetica", "bold");
  doc.text("General Motors of Canada Ltd.", pw / 2 + 10, y, { align: "center" });
  y += 6;
  doc.setFontSize(12); doc.setFont("helvetica", "bold");
  doc.text("National Parts Distribution Center", pw / 2, y, { align: "center" });
  y += 5;
  doc.text("Woodstock, Ontario", pw / 2, y, { align: "center" });
  y += 5;
  doc.text("Your Satisfaction Is Our Goal!", pw / 2, y, { align: "center" });
  y += 7;

  // ── Area / Station / Dealer info line ──
  doc.setFontSize(11); doc.setFont("helvetica", "bold");
  const areaLine = `Area:  ${settings.area || "80"}     Station No.:        ${settings.station || "587"}           Dealer Name:             ${settings.dealerName || ""}          Dealer Code: ${settings.dealerCode || ""}`;
  doc.text(areaLine, ml, y);
  y += 6;

  // ── "It was a pleasure..." (bold, NOT italic) ──
  doc.setFontSize(12); doc.setFont("helvetica", "bold");
  doc.text("It was a pleasure to pack your order.  Your satisfaction is our goal!", ml, y);
  y += 7;

  // ── Paragraph 1: mixed normal + bold ──
  doc.setFontSize(10); doc.setFont("helvetica", "normal");
  const p1a = "In order to improve the quality of your shipment, we ask that you complete this sheet when you receive";
  const p1aLines = doc.splitTextToSize(p1a, cw);
  doc.text(p1aLines, ml, y);
  // Calculate where "your order." ends to start bold text
  y += p1aLines.length * 4;
  doc.setFont("helvetica", "normal");
  const p1b = "your order.  ";
  doc.text(p1b, ml, y);
  const p1bW = doc.getTextWidth(p1b);
  doc.setFont("helvetica", "bold");
  const p1c = "This will allow us to start the investigation on any missing parts shipped out of";
  doc.text(p1c, ml + p1bW, y);
  y += 4;
  doc.text("Woodstock.", ml, y);
  y += 6;

  // ── "If you receive an overage..." (bold) ──
  doc.setFontSize(10); doc.setFont("helvetica", "bold");
  doc.text("If you receive an overage or wrong part, please claim on Parts Workbench.", ml, y);
  y += 6;

  // ── Warning paragraph with mixed bold+underline ──
  doc.setFontSize(9); doc.setFont("helvetica", "normal");
  let cx = ml;
  const writeText = (text, bold, underline) => {
    doc.setFont("helvetica", bold ? "bold" : "normal");
    // Handle word wrapping manually for mixed formatting
    const words = text.split(" ");
    for (let i = 0; i < words.length; i++) {
      const word = (i < words.length - 1) ? words[i] + " " : words[i];
      const ww = doc.getTextWidth(word);
      if (cx + ww > pw - mr) { cx = ml; y += 3.8; }
      doc.text(word, cx, y);
      if (underline) {
        const sz = doc.getFontSize();
        doc.setLineWidth(0.25);
        doc.line(cx, y + 0.5, cx + ww - (i < words.length - 1 ? doc.getTextWidth(" ") * 0.3 : 0), y + 0.5);
      }
      cx += ww;
    }
  };

  writeText("All parts received in a non-returnable condition must be reported within ", false, false);
  writeText("24 hours", true, true);
  writeText(" of receiving and ", false, false);
  writeText("claimed as damaged on Parts Workbench", true, true);
  writeText(". These parts will be accepted without penalty to your dealership. ", false, false);
  writeText("If you submit a return on a part in a non-returnable condition or has carrier caused damage that has not been reported within the 24 hours it will be refused.", true, true);
  y += 7; cx = ml;

  // ── Completed by / Date / Phone ──
  doc.setFontSize(12); doc.setFont("helvetica", "bold");
  doc.text(`Completed by: ${completedBy || "________________"}`, ml, y);
  doc.text(`Date: ${formDate || "_________"}`, ml + 75, y);
  doc.text(`Phone Number: ${settings.phone || "__________"}`, ml + 120, y);
  if (poInfo) { doc.setFontSize(7); doc.setFont("helvetica", "normal"); doc.text(`PO: ${poInfo.pbsPO}  GM#: ${poInfo.gmControl}`, pw - mr, y + 4, { align: "right" }); }
  y += 8;

  // ── Table styling (white header bg, black grid) ──
  const tOpts = {
    theme: "grid",
    headStyles: { fillColor: [255, 255, 255], textColor: [0, 0, 0], fontStyle: "bold", fontSize: 9, cellPadding: 1.5, halign: "center" },
    bodyStyles: { fontSize: 9, cellPadding: 1.5, minCellHeight: 6, textColor: [0, 0, 0] },
    styles: { lineColor: [0, 0, 0], lineWidth: 0.3, font: "helvetica" },
    margin: { left: ml, right: mr },
    tableLineColor: [0, 0, 0], tableLineWidth: 0.3
  };

  // ── SHORT INFO table (always shown) ──
  doc.autoTable({
    startY: y, ...tOpts,
    head: [
      [{ content: "SHORT INFO", colSpan: 6, styles: { halign: "center", fontStyle: "normal", fontSize: 10 } }],
      ["Item #", "Part #", "SO #", "QTY\nordered", "QTY\nReceived", "Tote or\nPallet ?"]
    ],
    headStyles: { ...tOpts.headStyles, fontSize: 9, cellPadding: 1.2 },
    body: [
      ...shortItems.map((r, i) => [String(i + 1), r.partNumber, r.shippingOrder, String(r.expectedQty), String(r.scannedQty), ""]),
      ...Array(Math.max(0, 4 - shortItems.length)).fill(["", "", "", "", "", ""])
    ],
    columnStyles: {
      0: { cellWidth: 18, halign: "center" },
      1: { cellWidth: 42 },
      2: { cellWidth: 42 },
      3: { cellWidth: 22, halign: "center" },
      4: { cellWidth: 22, halign: "center" },
      5: { cellWidth: 24, halign: "center" }
    }
  });
  y = doc.lastAutoTable.finalY + 4;

  // ── DIPP section title (bold + underlined text) ──
  doc.setFontSize(10); doc.setFont("helvetica", "bold");
  const dippTitle = "DIPP label Request \u2013  parts received with package damage/carrier damage or non-returnable";
  doc.text(dippTitle, ml, y);
  let dtw = doc.getTextWidth(dippTitle);
  doc.setLineWidth(0.25); doc.line(ml, y + 0.6, ml + dtw, y + 0.6);
  y += 4;
  const dippTitle2 = "condition";
  doc.text(dippTitle2, ml, y);
  const dtw2 = doc.getTextWidth(dippTitle2);
  doc.line(ml, y + 0.6, ml + dtw2, y + 0.6);
  y += 2;

  // ── DIPP table ──
  doc.autoTable({
    startY: y, ...tOpts,
    head: [["Part #", "PDC", "SO #", "Description", "Comments- i.e \u2013\nbox damaged,\nopen package", "DIPP\nrequested\n(Y/N)"]],
    headStyles: { ...tOpts.headStyles, fontSize: 8, cellPadding: 1.2 },
    body: [
      ...dippItems.map(item => [item.partNumber, item.pdc, item.shippingOrder, dippDescriptions[item.id] || "", dippComments[item.id] || "", "Y"]),
      ...Array(Math.max(0, 3 - dippItems.length)).fill(["", "", "", "", "", ""])
    ],
    columnStyles: {
      0: { cellWidth: 28, halign: "center" },
      1: { cellWidth: 18, halign: "center" },
      2: { cellWidth: 22, halign: "center" },
      3: { cellWidth: 38 },
      4: { cellWidth: 42 },
      5: { cellWidth: 22, halign: "center" }
    }
  });
  y = doc.lastAutoTable.finalY + 5;

  // ── Parts Received Belonging to Another Dealership (bold + underlined) ──
  doc.setFontSize(14); doc.setFont("helvetica", "bold");
  const wdTitle = "Parts Received Belonging to Another Dealership:";
  doc.text(wdTitle, ml, y);
  const wdtw = doc.getTextWidth(wdTitle);
  doc.setLineWidth(0.3); doc.line(ml, y + 0.7, ml + wdtw, y + 0.7);
  y += 2;

  // ── Wrong dealer table ──
  doc.autoTable({
    startY: y, ...tOpts,
    head: [["Part #", "Dealer Code", "SO #", "Did you contact\nthe dealer", "Do you require us\nto redirect the\npart?"]],
    headStyles: { ...tOpts.headStyles, fontSize: 8, cellPadding: 1.2 },
    body: [
      ...wrongDealerItems.map(item => [item.partNumber, item.dealerCode, item.shippingOrder, "", ""]),
      ...Array(Math.max(0, 2 - wrongDealerItems.length)).fill(["", "", "", "", ""])
    ],
    columnStyles: {
      0: { cellWidth: 30, halign: "center" },
      1: { cellWidth: 34, halign: "center" },
      2: { cellWidth: 30, halign: "center" },
      3: { cellWidth: 38, halign: "center" },
      4: { cellWidth: 38, halign: "center" }
    }
  });
  y = doc.lastAutoTable.finalY + 6;

  // ── Footer (always at bottom) ──
  doc.setFontSize(11); doc.setFont("helvetica", "bold");
  const footY = Math.max(y + 4, ph - 24);
  doc.text("RETURN BY FAX TO (519) 421-4766 or EMAIL wdk.courtesy@gm.com", pw / 2, footY, { align: "center" });
  doc.text("Dealer Fax Desk Phone (519) 421-4728", pw / 2, footY + 5, { align: "center" });

  return doc;
}

// ─── EML ─────────────────────────────────────────────────────────
function buildEML({ to, cc, subject, bodyText, pdfBase64, pdfFilename }) {
  const b = "----=_Part_" + Date.now().toString(36);
  let e = `From: \r\nTo: ${to}\r\n${cc ? `CC: ${cc}\r\n` : ""}Subject: ${subject}\r\nX-Unsent: 1\r\nMIME-Version: 1.0\r\nContent-Type: multipart/mixed; boundary="${b}"\r\n\r\n--${b}\r\nContent-Type: text/plain; charset="UTF-8"\r\nContent-Transfer-Encoding: 7bit\r\n\r\n${bodyText.replace(/\n/g, "\r\n")}\r\n\r\n--${b}\r\nContent-Type: application/pdf; name="${pdfFilename}"\r\nContent-Transfer-Encoding: base64\r\nContent-Disposition: attachment; filename="${pdfFilename}"\r\n\r\n`;
  for (let i = 0; i < pdfBase64.length; i += 76) e += pdfBase64.substring(i, i + 76) + "\r\n";
  return e + `\r\n--${b}--\r\n`;
}
function buildSubjectParts(si, di, wi) { const p = []; if (di.length) p.push("DIPP"); if (si.length) p.push("Did Not Receive"); if (wi.length) p.push("Parts for Another Dealer"); return p; }
function buildSubject(parts, dc, po) { return `${parts.length ? parts.join(" / ") : "Woodstock Form"} - ${dc}${po ? ` - ${po.gmControl || po.pbsPO}` : ""}`; }

// ─── Theme ───────────────────────────────────────────────────────
function makeTheme(m) {
  const d = m === "dark";
  return { bg0: d ? "#09090b" : "#f4f4f5", bg1: d ? "#0c0c0e" : "#ffffff", bg2: d ? "#111113" : "#ffffff", bg3: d ? "#18181b" : "#f4f4f5", bgInput: d ? "#09090b" : "#ffffff", border: d ? "#27272a" : "#d4d4d8", borderLight: d ? "#18181b" : "#e4e4e7", text: d ? "#e4e4e7" : "#18181b", textStrong: d ? "#fafafa" : "#09090b", textMuted: d ? "#71717a" : "#71717a", textFaint: d ? "#52525b" : "#a1a1aa", accent: "#dc2626", accentBg: d ? "#dc262620" : "#dc262610", accentText: d ? "#fca5a5" : "#dc2626", green: "#22c55e", greenText: d ? "#4ade80" : "#16a34a", greenBg: d ? "#0a2e1a" : "#f0fdf4", red: "#ef4444", redText: d ? "#f87171" : "#dc2626", redBg: d ? "#2e0a0a" : "#fef2f2", yellow: "#f59e0b", yellowText: d ? "#fbbf24" : "#d97706", yellowBg: d ? "#2e1a0a" : "#fffbeb", purple: "#a855f7", purpleText: d ? "#c084fc" : "#7c3aed", purpleBg: d ? "#1a0a2e" : "#faf5ff", blue: "#3b82f6", blueText: d ? "#60a5fa" : "#2563eb", blueBg: d ? "#0a1a2e" : "#eff6ff", shadow: d ? "none" : "0 1px 3px rgba(0,0,0,0.06)" };
}

const DIPP_PRESETS = ["Box damaged", "Open package", "Water damage", "Crushed box", "Torn packaging", "Missing label", "Carrier damage", "Non-returnable"];
const STATUS_CFG = { match: { label: "MATCH" }, overage: { label: "OVERAGE" }, short: { label: "SHORT" } };

// ═══════════════════════════════════════════════════════════════════
export default function App() {
  const [appMode, setAppMode] = useState(null);
  const [settings, setSettings] = useState(() => loadSettings());
  const [showSettings, setShowSettings] = useState(false);
  const [settingsTab, setSettingsTab] = useState("general");
  const [settingsDraft, setSettingsDraft] = useState(DEFAULTS);
  const [newDC, setNewDC] = useState(""); const [newDN, setNewDN] = useState(""); const [newDCo, setNewDCo] = useState(""); const [newDE, setNewDE] = useState("");
  const t = makeTheme(settings.theme);
  const ff = "'JetBrains Mono','Fira Code','SF Mono','Consolas',monospace";

  const [scannedItems, setScannedItems] = useState(() => loadScans());
  const [pendingUS, setPendingUS] = useState(null);
  const [lastFeedback, setLastFeedback] = useState(null);
  const [wrongDealerPopup, setWrongDealerPopup] = useState(null);
  const [qtyEditId, setQtyEditId] = useState(null);
  const [qtyEditVal, setQtyEditVal] = useState("");
  const feedbackTimer = useRef(null);

  const [wsTab, setWsTab] = useState("scan");
  const [purchaseOrders, setPurchaseOrders] = useState([]);
  const [activePO, setActivePO] = useState(null);
  const [selectedShipment, setSelectedShipment] = useState("all");
  const [dippComments, setDippComments] = useState({});
  const [dippDescriptions, setDippDescriptions] = useState({});
  const [completedBy, setCompletedBy] = useState("");
  const [formDate, setFormDate] = useState(new Date().toISOString().split("T")[0]);
  const [pdfGenerating, setPdfGenerating] = useState(false);
  const [lastPdfBase64, setLastPdfBase64] = useState(null);
  const [lastPdfBlob, setLastPdfBlob] = useState(null);
  const [lastPdfName, setLastPdfName] = useState("");
  const [scanInput, setScanInput] = useState("");
  const [csvText, setCsvText] = useState(""); const [csvPO, setCsvPO] = useState("");
  const scanRef = useRef(null);
  const fileInputRef = useRef(null);

  // Persist settings + scans
  useEffect(() => { saveSettingsToStorage(settings); }, [settings]);
  useEffect(() => { saveScans(scannedItems); }, [scannedItems]);

  // ─── Scanner→Workstation Sync ───────────────────────────────
  const syncVersion = useRef(0);
  const syncPushTimer = useRef(null);

  // Scanner mode: push scans to server on every change (debounced)
  useEffect(() => {
    if (appMode !== "scanner" || scannedItems.length === 0) return;
    if (syncPushTimer.current) clearTimeout(syncPushTimer.current);
    syncPushTimer.current = setTimeout(() => {
      fetch("/api/scans", { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ scans: scannedItems }) }).catch(() => {});
    }, 500);
    return () => { if (syncPushTimer.current) clearTimeout(syncPushTimer.current); };
  }, [scannedItems, appMode]);

  // Workstation mode: poll server for scanner updates every 2s
  useEffect(() => {
    if (appMode !== "workstation") return;
    const poll = setInterval(async () => {
      try {
        const r = await fetch("/api/version");
        const d = await r.json();
        if (d.version > syncVersion.current) {
          syncVersion.current = d.version;
          const r2 = await fetch("/api/scans");
          const d2 = await r2.json();
          if (d2.scans && d2.scans.length > 0) {
            setScannedItems(prev => {
              const existingIds = new Set(prev.map(i => i.id));
              const newItems = d2.scans.filter(s => !existingIds.has(s.id));
              if (newItems.length === 0) return prev;
              return [...prev, ...newItems];
            });
          }
        }
      } catch (e) {}
    }, 2000);
    return () => clearInterval(poll);
  }, [appMode]);

  const showFB = useCallback((msg, color, duration = 4000) => {
    if (feedbackTimer.current) clearTimeout(feedbackTimer.current);
    setLastFeedback({ msg, color });
    feedbackTimer.current = setTimeout(() => setLastFeedback(null), duration);
  }, []);

  const lookupDealer = (code) => settings.knownDealers.find(d => d.code === code) || null;
  const openSettings = () => { setSettingsDraft(JSON.parse(JSON.stringify(settings))); setShowSettings(true); setSettingsTab("general"); };
  const saveSettingsHandler = () => { setSettings(JSON.parse(JSON.stringify(settingsDraft))); setShowSettings(false); };
  const addKnownDealer = () => { const c = newDC.trim(), n = newDN.trim(), co = newDCo.trim(), em = newDE.trim(); if (!c || !n) return; const entry = { code: c, name: n, contact: co, email: em }; setSettingsDraft(p => ({ ...p, knownDealers: p.knownDealers.find(d => d.code === c) ? p.knownDealers.map(d => d.code === c ? entry : d) : [...p.knownDealers, entry] })); setNewDC(""); setNewDN(""); setNewDCo(""); setNewDE(""); };
  const removeKnownDealer = (code) => setSettingsDraft(p => ({ ...p, knownDealers: p.knownDealers.filter(d => d.code !== code) }));

  // ─── Scan Engine ───────────────────────────────────────────
  const processScan = useCallback((rawInput) => {
    const val = rawInput.trim(); if (!val) return;
    const dc = settings.dealerCode;
    const cls = classifyScan(val);

    if (cls === "quantity") {
      setScannedItems(prev => { if (!prev.length) return prev; const u = [...prev]; u[u.length - 1] = { ...u[u.length - 1], quantity: parseInt(val, 10) }; return u; });
      showFB(`QTY → ${val}`, t.yellow); return;
    }
    if (cls === "canadian") {
      const p = parseCanadianBarcode(val, dc);
      if (p) { addItem(p); if (p.wrongDealer) { const dn = lookupDealer(p.dealerCode); setWrongDealerPopup({ ...p, dealerName: dn?.name || null }); showFB(`⚠ WRONG DEALER: ${p.dealerCode}${dn ? ` (${dn.name})` : ""} — ${p.partNumber}`, t.purple, 8000); } else showFB(`✓ ${p.partNumber}  SO:${p.shippingOrder}  PDC:${p.pdc}`, t.green); setPendingUS(null); return; }
    }
    if (cls === "us_full") {
      const p = parseUSBarcode(val, dc);
      if (p) { addItem(p); if (p.wrongDealer) { const dn = lookupDealer(p.dealerCode); setWrongDealerPopup({ ...p, dealerName: dn?.name || null }); showFB(`⚠ WRONG DEALER: ${p.dealerCode} — ${p.partNumber}`, t.purple, 8000); } else showFB(`✓ US: ${p.partNumber}  SO:${p.shippingOrder}`, t.green); setPendingUS(null); return; }
    }
    if (cls === "us_header_old" || cls === "us_header_new") {
      const headerVal = cls === "us_header_new" ? val.substring(0, 10) : val;
      if (pendingUS && pendingUS.type === "part") {
        const combined = headerVal + dc + pendingUS.value;
        const p = parseUSBarcode(combined, dc); setPendingUS(null);
        if (p) { addItem(p); if (p.wrongDealer) { const dn = lookupDealer(p.dealerCode); setWrongDealerPopup({ ...p, dealerName: dn?.name || null }); showFB(`⚠ WRONG DEALER — ${p.partNumber}`, t.purple, 8000); } else showFB(`✓ US: ${p.partNumber}  SO:${p.shippingOrder}`, t.green); } else showFB(`✗ Could not parse US barcode`, t.red);
        return;
      }
      setPendingUS({ type: "header", value: headerVal, time: Date.now() });
      showFB(`⏳ US header scanned — now scan part label (either order works)`, t.yellow); return;
    }
    if (cls === "us_part") {
      if (pendingUS && pendingUS.type === "header") {
        const combined = pendingUS.value + dc + val;
        const p = parseUSBarcode(combined, dc); setPendingUS(null);
        if (p) { addItem(p); if (p.wrongDealer) { const dn = lookupDealer(p.dealerCode); setWrongDealerPopup({ ...p, dealerName: dn?.name || null }); showFB(`⚠ WRONG DEALER — ${p.partNumber}`, t.purple, 8000); } else showFB(`✓ US: ${p.partNumber}  SO:${p.shippingOrder}`, t.green); } else showFB(`✗ Could not parse US barcode`, t.red);
        return;
      }
      setPendingUS({ type: "part", value: val, time: Date.now() });
      showFB(`⏳ Part # scanned — now scan shipping header`, t.yellow); return;
    }
    if (cls === "incomplete_canadian") { showFB(`⚠ INCOMPLETE — Expected 34-35 chars, got ${val.length}. Rescan.`, t.red, 6000); setPendingUS(null); return; }
    if (cls === "incomplete_short") { showFB(`⚠ TOO SHORT (${val.length} chars) — Incomplete? Rescan.`, t.red, 6000); return; }
    if (cls === "too_long") { showFB(`⚠ TOO LONG (${val.length} chars) — Double scan? Rescan one label.`, t.red, 6000); setPendingUS(null); return; }
    showFB(`? Unknown format (${val.length} chars). Check label.`, t.red, 6000);
  }, [pendingUS, settings, showFB, t]);

  const addItem = (parsed) => {
    setScannedItems(prev => {
      const ex = prev.find(i => i.partNumber === parsed.partNumber && i.shippingOrder === parsed.shippingOrder);
      if (ex) return prev.map(i => i.partNumber === parsed.partNumber && i.shippingOrder === parsed.shippingOrder ? { ...i, quantity: i.quantity + 1, scans: [...i.scans, parsed.raw] } : i);
      return [...prev, { ...parsed, quantity: 1, scans: [parsed.raw], id: Date.now() + Math.random(), dipp: false }];
    });
  };

  const handleScanKeyDown = (e) => { if (e.key === "Enter" || e.key === "Tab") { e.preventDefault(); processScan(scanInput); setScanInput(""); } };
  const toggleDipp = (id) => setScannedItems(prev => prev.map(i => i.id === id ? { ...i, dipp: !i.dipp } : i));
  const delScan = (id) => setScannedItems(prev => prev.filter(i => i.id !== id));
  const adjQty = (id, d) => setScannedItems(prev => prev.map(i => i.id === id ? { ...i, quantity: Math.max(1, i.quantity + d) } : i));
  const setQty = (id, q) => { const n = parseInt(q, 10); if (n >= 1) setScannedItems(prev => prev.map(i => i.id === id ? { ...i, quantity: n } : i)); };
  const getWD = () => scannedItems.filter(i => i.wrongDealer);
  const getDipp = () => scannedItems.filter(i => i.dipp);
  const stats = { total: scannedItems.reduce((s, i) => s + i.quantity, 0), unique: scannedItems.length, wd: getWD().length, dipp: getDipp().length, so: [...new Set(scannedItems.map(i => i.shippingOrder))].length };

  // ─── PWB+ / Comparison ────────────────────────────────────
  const handleFileUpload = async (e) => { for (const file of Array.from(e.target.files)) { try { const raw = await parseXLSXFile(file), info = parseFilename(file.name), norm = normPWB(raw); const po = { id: Date.now() + Math.random(), ...info, filename: file.name, data: norm }; setPurchaseOrders(prev => { const ex = prev.find(p => p.pbsPO === po.pbsPO && p.gmControl === po.gmControl); return ex ? prev.map(p => p.pbsPO === po.pbsPO && p.gmControl === po.gmControl ? po : p) : [...prev, po]; }); if (!activePO) setActivePO(info.pbsPO); showFB(`✓ PO ${info.pbsPO} — ${norm.length} lines`, t.green); } catch (err) { showFB(`Error: ${err.message}`, t.red); } } if (fileInputRef.current) fileInputRef.current.value = ""; };
  const handleCSVPaste = () => { const raw = parseCSVText(csvText); if (!raw.length) { showFB("No data", t.red); return; } const norm = normPWB(raw), name = csvPO.trim() || `paste-${Date.now()}`; setPurchaseOrders(prev => [...prev, { id: Date.now(), pbsPO: name, gmControl: "", dateStr: "", filename: "pasted", data: norm }]); if (!activePO) setActivePO(name); setCsvText(""); setCsvPO(""); showFB(`✓ ${norm.length} lines`, t.green); };
  const normPWB = (data) => data.map(row => ({ status: row["Current Status"] || "", partOrdered: String(row["Part No. Ordered"] || "").replace(/\s/g, ""), partProcessed: String(row["Part No. Processed"] || "").replace(/\s/g, ""), facility: row["Facility"] || "", qtyOrdered: parseInt(row["Qty Ordered"] || 0), qtyProc: parseInt(row["Qty Proc."] || 0), shipmentNo: String(row["Shipment No."] || "").replace(/\s/g, ""), superseded: String(row["Part No. Ordered"] || "").replace(/\s/g, "") !== String(row["Part No. Processed"] || "").replace(/\s/g, "") }));
  const removePO = (id) => { setPurchaseOrders(prev => { const po = prev.find(p => p.id === id), next = prev.filter(p => p.id !== id); if (po && activePO === po.pbsPO) setActivePO(next.length ? next[0].pbsPO : null); return next; }); };
  const getPWB = () => { if (activePO === "__all__") return purchaseOrders.flatMap(p => p.data); return (purchaseOrders.find(p => p.pbsPO === activePO) || {}).data || []; };
  const getShipNums = () => { const n = new Set(); getPWB().forEach(r => { if (r.shipmentNo) n.add(r.shipmentNo); }); scannedItems.forEach(r => { if (r.shippingOrder) n.add(r.shippingOrder); }); return [...n].sort(); };
  const getComp = () => {
    const shipped = getPWB().filter(r => r.status === "Shipped" && (selectedShipment === "all" || r.shipmentNo === selectedShipment)); const results = [], matched = new Set();
    shipped.forEach(pwb => { const part = pwb.partProcessed || pwb.partOrdered; const scan = scannedItems.find(s => s.partNumber === part && (selectedShipment === "all" || s.shippingOrder === pwb.shipmentNo)); if (scan) { matched.add(scan.id); const diff = scan.quantity - pwb.qtyProc; results.push({ partNumber: part, partOrdered: pwb.partOrdered, superseded: pwb.superseded, expectedQty: pwb.qtyProc, scannedQty: scan.quantity, qtyDiff: diff, shippingOrder: pwb.shipmentNo, facility: pwb.facility, status: diff === 0 ? "match" : diff > 0 ? "overage" : "short", wrongDealer: scan.wrongDealer, dealerCode: scan.dealerCode, dipp: scan.dipp }); } else results.push({ partNumber: part, partOrdered: pwb.partOrdered, superseded: pwb.superseded, expectedQty: pwb.qtyProc, scannedQty: 0, qtyDiff: -pwb.qtyProc, shippingOrder: pwb.shipmentNo, facility: pwb.facility, status: "short", wrongDealer: false }); });
    scannedItems.forEach(scan => { if (!matched.has(scan.id) && (selectedShipment === "all" || scan.shippingOrder === selectedShipment)) results.push({ partNumber: scan.partNumber, partOrdered: scan.partNumber, superseded: false, expectedQty: 0, scannedQty: scan.quantity, qtyDiff: scan.quantity, shippingOrder: scan.shippingOrder, facility: scan.pdc, status: "overage", wrongDealer: scan.wrongDealer, dealerCode: scan.dealerCode, dipp: scan.dipp }); });
    return results.sort((a, b) => ({ short: 0, overage: 1, match: 2 }[a.status] ?? 3) - ({ short: 0, overage: 1, match: 2 }[b.status] ?? 3) || a.partNumber.localeCompare(b.partNumber));
  };
  const comp = purchaseOrders.length > 0 ? getComp() : [];
  const nM = comp.filter(r => r.status === "match").length, nS = comp.filter(r => r.status === "short").length, nO = comp.filter(r => r.status === "overage").length;
  const shortItems = comp.filter(r => r.status === "short" && r.expectedQty > 0);
  const poInfo = purchaseOrders.find(p => p.pbsPO === activePO) || null;
  const subParts = buildSubjectParts(shortItems, getDipp(), getWD());
  const emailSubject = buildSubject(subParts, settings.dealerCode, poInfo);
  const getCCStr = () => { const codes = [...new Set(getWD().map(i => i.dealerCode))]; return codes.map(c => lookupDealer(c)).filter(d => d?.email).map(d => `${d.contact ? `"${d.contact}" ` : ""}<${d.email}>`).join(", "); };

  const generatePDFHandler = async () => { setPdfGenerating(true); try { const doc = generateWoodstockPDF({ settings, shortItems, dippItems: getDipp(), dippComments, dippDescriptions, wrongDealerItems: getWD(), completedBy, formDate, poInfo }); const fn = `woodstock_form_${poInfo ? `${poInfo.pbsPO}_${poInfo.gmControl}` : "form"}_${formDate}.pdf`; setLastPdfBlob(doc.output("blob")); setLastPdfBase64(doc.output("datauristring").split(",")[1]); setLastPdfName(fn); doc.save(fn); showFB("✓ PDF generated", t.green); } catch (err) { showFB(`PDF error: ${err.message}`, t.red); } setPdfGenerating(false); };
  const printPDF = () => { if (!lastPdfBlob) return; const w = window.open(URL.createObjectURL(lastPdfBlob)); if (w) w.addEventListener("load", () => setTimeout(() => w.print(), 500)); };
  const emailOutlook = () => { if (!lastPdfBase64) return; const body = `Please find the attached Woodstock form for dealer ${settings.dealerCode} (${settings.dealerName}).\n\nDate: ${formDate}\nCompleted by: ${completedBy || "(not specified)"}\nPhone: ${settings.phone}${poInfo ? `\nPO: ${poInfo.pbsPO} / GM Control: ${poInfo.gmControl}` : ""}\n\nSummary:\n${shortItems.length ? `- ${shortItems.length} short\n` : ""}${getDipp().length ? `- ${getDipp().length} DIPP\n` : ""}${getWD().length ? `- ${getWD().length} wrong dealer\n` : ""}`; const eml = buildEML({ to: settings.wdkEmail, cc: getCCStr(), subject: emailSubject, bodyText: body, pdfBase64: lastPdfBase64, pdfFilename: lastPdfName }); const a = document.createElement("a"); a.href = URL.createObjectURL(new Blob([eml], { type: "message/rfc822" })); a.download = `woodstock_${formDate}.eml`; document.body.appendChild(a); a.click(); document.body.removeChild(a); showFB("✓ .eml downloaded — open in Outlook", t.green); };

  // ─── Styles ─────────────────────────────────────────────────
  const S = {
    overlay: { position: "fixed", inset: 0, background: "rgba(0,0,0,0.5)", zIndex: 200, display: "flex", alignItems: "center", justifyContent: "center", padding: 16 },
    modal: { background: t.bg2, border: `1px solid ${t.border}`, borderRadius: 12, width: 540, maxWidth: "100%", maxHeight: "90vh", boxShadow: "0 20px 60px rgba(0,0,0,0.3)", overflow: "auto" },
    btn: (b, c) => ({ padding: "5px 12px", background: b, color: c, border: "none", borderRadius: 4, cursor: "pointer", fontFamily: ff, fontSize: 11, fontWeight: 600 }),
    sm: (b, c) => ({ padding: "2px 7px", background: b, color: c, border: "none", borderRadius: 3, cursor: "pointer", fontFamily: ff, fontSize: 10, fontWeight: 600 }),
    bg: (b, c) => ({ display: "inline-block", padding: "2px 7px", borderRadius: 3, fontSize: 9, fontWeight: 700, background: b, color: c }),
    inp: { padding: "5px 9px", background: t.bgInput, border: `1px solid ${t.border}`, borderRadius: 4, color: t.text, fontFamily: ff, fontSize: 12, boxSizing: "border-box" },
    sel: { padding: "5px 9px", background: t.bgInput, border: `1px solid ${t.border}`, borderRadius: 4, color: t.text, fontFamily: ff, fontSize: 12 },
    tbl: { width: "100%", borderCollapse: "collapse" },
    th: { padding: "6px 10px", textAlign: "left", fontSize: 9, fontWeight: 700, color: t.textMuted, letterSpacing: 1.2, textTransform: "uppercase", borderBottom: `1px solid ${t.border}`, background: t.bg1 },
    td: c => ({ padding: "6px 10px", borderBottom: `1px solid ${t.borderLight}`, fontSize: 12, color: c || t.text }),
    card: { background: t.bg2, border: `1px solid ${t.border}`, borderRadius: 8, marginBottom: 10, overflow: "hidden", boxShadow: t.shadow },
    cH: { padding: "9px 12px", borderBottom: `1px solid ${t.border}`, display: "flex", justifyContent: "space-between", alignItems: "center", flexWrap: "wrap", gap: 8 },
    cL: { fontSize: 10, fontWeight: 700, color: t.textMuted, letterSpacing: 1.2, textTransform: "uppercase" },
    lbl: { fontSize: 10, color: t.textMuted, marginBottom: 3, display: "block", letterSpacing: .5, textTransform: "uppercase", fontWeight: 600 },
    dot: c => ({ display: "inline-block", width: 7, height: 7, borderRadius: "50%", background: c }),
    mI: { width: "100%", padding: "8px 10px", background: t.bgInput, border: `1px solid ${t.border}`, borderRadius: 4, color: t.text, fontFamily: ff, fontSize: 13, boxSizing: "border-box" },
    stab: on => ({ padding: "6px 14px", border: "none", borderBottom: on ? `2px solid ${t.accent}` : "2px solid transparent", background: "transparent", color: on ? t.textStrong : t.textMuted, fontFamily: ff, fontSize: 11, fontWeight: on ? 600 : 400, cursor: "pointer" }),
    pill: c => ({ padding: "3px 8px", borderRadius: 4, fontSize: 10, fontWeight: 600, color: c, background: `${c}10`, border: `1px solid ${c}20` }),
    empty: { padding: "32px 16px", textAlign: "center", color: t.textFaint, fontSize: 12 },
    fb: c => ({ padding: "8px 12px", background: `${c}10`, borderLeft: `3px solid ${c}`, color: c, fontSize: 12, fontWeight: 600, marginTop: 6, borderRadius: "0 4px 4px 0" }),
  };
  const sc = (s) => ({ match: { bg: `${t.green}20`, tx: t.greenText, row: t.greenBg }, overage: { bg: `${t.yellow}20`, tx: t.yellowText, row: t.yellowBg }, short: { bg: `${t.red}20`, tx: t.redText, row: t.redBg } }[s] || { bg: t.bg3, tx: t.textMuted, row: "transparent" });
  const Bdg = ({ n, c }) => n > 0 ? <span style={{ padding: "1px 5px", borderRadius: 7, fontSize: 9, fontWeight: 700, background: c, color: "#fff", minWidth: 14, textAlign: "center", display: "inline-block" }}>{n}</span> : null;

  // ═══ Settings Modal ════════════════════════════════════════
  const settingsModal = showSettings && (
    <div style={S.overlay} onClick={() => setShowSettings(false)}>
      <div style={S.modal} onClick={e => e.stopPropagation()}>
        <div style={{ padding: "14px 16px", borderBottom: `1px solid ${t.border}`, display: "flex", justifyContent: "space-between", position: "sticky", top: 0, background: t.bg2, zIndex: 1 }}><span style={{ fontWeight: 700, fontSize: 14, color: t.textStrong }}>Settings</span><button style={S.sm(t.bg3, t.textMuted)} onClick={() => setShowSettings(false)}>✕</button></div>
        <div style={{ display: "flex", borderBottom: `1px solid ${t.border}` }}><button style={S.stab(settingsTab === "general")} onClick={() => setSettingsTab("general")}>General</button><button style={S.stab(settingsTab === "dealers")} onClick={() => setSettingsTab("dealers")}>Dealers</button></div>
        <div style={{ padding: 16 }}>
          {settingsTab === "general" && (<>
            <div style={{ marginBottom: 14 }}><label style={S.lbl}>Dealer Code</label><input style={S.mI} value={settingsDraft.dealerCode} onChange={e => setSettingsDraft(p => ({ ...p, dealerCode: e.target.value }))} /></div>
            <div style={{ marginBottom: 14 }}><label style={S.lbl}>Dealer Name</label><input style={S.mI} value={settingsDraft.dealerName} onChange={e => setSettingsDraft(p => ({ ...p, dealerName: e.target.value }))} /></div>
            <div style={{ display: "flex", gap: 12 }}><div style={{ flex: 1, marginBottom: 14 }}><label style={S.lbl}>Area</label><input style={S.mI} value={settingsDraft.area} onChange={e => setSettingsDraft(p => ({ ...p, area: e.target.value }))} /></div><div style={{ flex: 1, marginBottom: 14 }}><label style={S.lbl}>Station</label><input style={S.mI} value={settingsDraft.station} onChange={e => setSettingsDraft(p => ({ ...p, station: e.target.value }))} /></div></div>
            <div style={{ marginBottom: 14 }}><label style={S.lbl}>Phone</label><input style={S.mI} value={settingsDraft.phone} onChange={e => setSettingsDraft(p => ({ ...p, phone: e.target.value }))} /></div>
            <div style={{ marginBottom: 14 }}><label style={S.lbl}>Woodstock Email</label><input style={S.mI} value={settingsDraft.wdkEmail} onChange={e => setSettingsDraft(p => ({ ...p, wdkEmail: e.target.value }))} /></div>
            <div style={{ marginBottom: 14 }}><label style={S.lbl}>Theme</label><div style={{ display: "flex", gap: 8, marginTop: 4 }}>{["light", "dark"].map(m => <button key={m} onClick={() => setSettingsDraft(p => ({ ...p, theme: m }))} style={{ padding: "8px 20px", borderRadius: 6, border: `2px solid ${settingsDraft.theme === m ? t.accent : t.border}`, background: m === "dark" ? "#18181b" : "#f8f8fa", color: m === "dark" ? "#e4e4e7" : "#18181b", fontFamily: ff, fontSize: 12, fontWeight: settingsDraft.theme === m ? 700 : 400, cursor: "pointer" }}>{m === "light" ? "☀ Light" : "🌙 Dark"}</button>)}</div></div>
          </>)}
          {settingsTab === "dealers" && (<>
            <div style={{ marginBottom: 12, fontSize: 11, color: t.textMuted }}>Dealer directory for wrong-dealer ID and email CC.</div>
            <div style={{ background: t.bg0, border: `1px solid ${t.border}`, borderRadius: 6, padding: 10, marginBottom: 12 }}>
              <div style={{ display: "flex", gap: 6, marginBottom: 6, flexWrap: "wrap" }}><input style={{ ...S.inp, width: 80 }} placeholder="Code" value={newDC} onChange={e => setNewDC(e.target.value)} /><input style={{ ...S.inp, flex: 1, minWidth: 100 }} placeholder="Dealer Name" value={newDN} onChange={e => setNewDN(e.target.value)} /></div>
              <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}><input style={{ ...S.inp, flex: 1 }} placeholder="Contact" value={newDCo} onChange={e => setNewDCo(e.target.value)} /><input style={{ ...S.inp, flex: 1 }} placeholder="Email" value={newDE} onChange={e => setNewDE(e.target.value)} onKeyDown={e => { if (e.key === "Enter") addKnownDealer(); }} /><button style={S.btn(t.accent, "#fff")} onClick={addKnownDealer}>Add</button></div>
            </div>
            {settingsDraft.knownDealers.length === 0 ? <div style={S.empty}>Empty</div> :
              <table style={S.tbl}><thead><tr><th style={S.th}>Code</th><th style={S.th}>Dealer</th><th style={S.th}>Contact</th><th style={S.th}>Email</th><th style={S.th}></th></tr></thead><tbody>
                {settingsDraft.knownDealers.map(d => <tr key={d.code}><td style={S.td(t.textStrong)}><strong>{d.code}</strong>{d.code === settingsDraft.dealerCode && <span style={{ ...S.bg(`${t.green}20`, t.greenText), marginLeft: 6 }}>YOU</span>}</td><td style={S.td()}>{d.name}</td><td style={S.td()}>{d.contact || "—"}</td><td style={S.td()}>{d.email || "—"}</td><td style={S.td()}><button style={S.sm(t.bg3, t.textFaint)} onClick={() => removeKnownDealer(d.code)}>✕</button></td></tr>)}
              </tbody></table>}
          </>)}
        </div>
        <div style={{ padding: "12px 16px", borderTop: `1px solid ${t.border}`, display: "flex", justifyContent: "flex-end", gap: 8, position: "sticky", bottom: 0, background: t.bg2 }}><button style={S.btn(t.bg3, t.textMuted)} onClick={() => setShowSettings(false)}>Cancel</button><button style={S.btn(t.accent, "#fff")} onClick={saveSettingsHandler}>Save</button></div>
      </div>
    </div>
  );

  // ═══ Wrong Dealer Popup ════════════════════════════════════
  const wdPopup = wrongDealerPopup && (
    <div style={S.overlay} onClick={() => setWrongDealerPopup(null)}>
      <div onClick={e => e.stopPropagation()} style={{ background: t.bg2, border: `3px solid ${t.purple}`, borderRadius: 16, width: 400, maxWidth: "90vw", boxShadow: `0 0 40px ${t.purple}40`, overflow: "hidden" }}>
        <div style={{ background: `${t.purple}15`, padding: "16px 20px", textAlign: "center" }}><div style={{ fontSize: 32 }}>⚠</div><div style={{ fontSize: 18, fontWeight: 900, color: t.purpleText, fontFamily: ff }}>WRONG DEALER</div></div>
        <div style={{ padding: "16px 20px", textAlign: "center" }}>
          <div style={{ fontSize: 28, fontWeight: 900, color: t.purpleText, fontFamily: ff, marginBottom: 8 }}>{wrongDealerPopup.dealerCode}</div>
          {wrongDealerPopup.dealerName ? <div style={{ fontSize: 16, fontWeight: 600, color: t.text, marginBottom: 12 }}>{wrongDealerPopup.dealerName}</div> : <div style={{ fontSize: 13, color: t.textFaint, marginBottom: 12, fontStyle: "italic" }}>Unknown dealer — add in Settings</div>}
          <div style={{ fontSize: 13, color: t.textMuted }}>Part: <strong style={{ color: t.textStrong }}>{wrongDealerPopup.partNumber}</strong></div>
          <div style={{ fontSize: 13, color: t.textMuted }}>SO: <strong>{wrongDealerPopup.shippingOrder}</strong> &nbsp; PDC: <strong>{wrongDealerPopup.pdc}</strong></div>
          <div style={{ fontSize: 11, color: t.textFaint, marginTop: 8 }}>Expected: {settings.dealerCode} ({settings.dealerName})</div>
        </div>
        <div style={{ padding: "12px 20px", borderTop: `1px solid ${t.border}`, display: "flex", justifyContent: "center" }}><button style={{ padding: "10px 24px", background: t.purple, color: "#fff", border: "none", borderRadius: 8, fontFamily: ff, fontSize: 14, fontWeight: 700, cursor: "pointer" }} onClick={() => setWrongDealerPopup(null)}>OK — Continue</button></div>
      </div>
    </div>
  );

  // ═══ MODE CHOOSER ══════════════════════════════════════════
  if (appMode === null) {
    return (
      <div style={{ fontFamily: ff, background: t.bg0, color: t.text, minHeight: "100vh", display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", gap: 24, padding: 24 }}>
        {settingsModal}
        <div style={{ width: 40, height: 40, background: "linear-gradient(135deg,#dc2626,#991b1b)", borderRadius: 8, display: "flex", alignItems: "center", justifyContent: "center", fontWeight: 900, fontSize: 16, color: "#fff" }}>GM</div>
        <div style={{ textAlign: "center" }}><div style={{ fontSize: 18, fontWeight: 700, color: t.textStrong }}>Parts Receiving</div><div style={{ fontSize: 11, color: t.textMuted, marginTop: 4 }}>{settings.dealerName} · {settings.dealerCode}</div></div>
        <div style={{ display: "flex", gap: 16, flexWrap: "wrap", justifyContent: "center" }}>
          {[["scanner", "📱", "Scanner", "Handheld / Datalogic", "Scan, flag, count"], ["workstation", "🖥", "Workstation", "Full desktop", "Compare, forms, email"]].map(([mode, icon, title, sub1, sub2]) => (
            <button key={mode} onClick={() => setAppMode(mode)} style={{ padding: "24px 32px", background: t.bg2, border: `2px solid ${t.border}`, borderRadius: 12, cursor: "pointer", fontFamily: ff, textAlign: "center", minWidth: 180, boxShadow: t.shadow }}>
              <div style={{ fontSize: 32, marginBottom: 8 }}>{icon}</div><div style={{ fontSize: 14, fontWeight: 700, color: t.textStrong }}>{title}</div><div style={{ fontSize: 10, color: t.textMuted, marginTop: 4 }}>{sub1}<br />{sub2}</div>
            </button>
          ))}
        </div>
        <button style={{ ...S.btn(t.bg3, t.textMuted), marginTop: 8 }} onClick={openSettings}>⚙ Settings</button>
      </div>
    );
  }

  // ═══ SCANNER MODE ══════════════════════════════════════════
  if (appMode === "scanner") {
    return (
      <div style={{ fontFamily: ff, background: t.bg0, color: t.text, minHeight: "100vh", fontSize: 13 }}>
        {settingsModal}{wdPopup}
        {qtyEditId && <div style={S.overlay} onClick={() => setQtyEditId(null)}><div onClick={e => e.stopPropagation()} style={{ background: t.bg2, border: `1px solid ${t.border}`, borderRadius: 12, padding: 20, width: 280, textAlign: "center" }}><div style={{ fontSize: 12, color: t.textMuted, marginBottom: 8, fontWeight: 600 }}>SET QUANTITY</div><input autoFocus type="number" min="1" max="999" value={qtyEditVal} onChange={e => setQtyEditVal(e.target.value)} onKeyDown={e => { if (e.key === "Enter") { setQty(qtyEditId, qtyEditVal); setQtyEditId(null); } }} style={{ width: 100, padding: 12, background: t.bgInput, border: `2px solid ${t.accent}`, borderRadius: 8, color: t.textStrong, fontFamily: ff, fontSize: 28, textAlign: "center", outline: "none" }} /><div style={{ display: "flex", gap: 8, marginTop: 12, justifyContent: "center" }}><button style={{ ...S.btn(t.bg3, t.textMuted), padding: "8px 20px" }} onClick={() => setQtyEditId(null)}>Cancel</button><button style={{ ...S.btn(t.accent, "#fff"), padding: "8px 20px" }} onClick={() => { setQty(qtyEditId, qtyEditVal); setQtyEditId(null); }}>Set</button></div></div></div>}
        <div style={{ background: t.bg1, borderBottom: `1px solid ${t.border}`, padding: "8px 12px", display: "flex", alignItems: "center", justifyContent: "space-between", position: "sticky", top: 0, zIndex: 100 }}>
          <div style={{ display: "flex", alignItems: "center", gap: 8 }}><button style={S.sm(t.bg3, t.textMuted)} onClick={() => setAppMode(null)}>←</button><span style={{ fontWeight: 700, fontSize: 13, color: t.textStrong }}>Scanner</span></div>
          <div style={{ display: "flex", gap: 4 }}><span style={S.pill(t.text)}>{stats.total}</span>{stats.wd > 0 && <span style={S.pill(t.purpleText)}>⚠{stats.wd}</span>}{stats.dipp > 0 && <span style={S.pill(t.blueText)}>D{stats.dipp}</span>}<button style={{ ...S.sm(t.bg3, t.textMuted), fontSize: 14 }} onClick={openSettings}>⚙</button></div>
        </div>
        {pendingUS && <div style={{ padding: "8px 12px", background: t.yellowBg, borderBottom: `2px solid ${t.yellow}`, color: t.yellowText, fontSize: 12, fontWeight: 600, display: "flex", justifyContent: "space-between" }}><span>⏳ Waiting for US {pendingUS.type === "header" ? "part" : "header"}…</span><button style={S.sm(`${t.yellow}20`, t.yellowText)} onClick={() => setPendingUS(null)}>Cancel</button></div>}
        <div style={{ padding: 12 }}>
          <input ref={scanRef} autoFocus autoComplete="off" style={{ width: "100%", padding: 14, background: t.bgInput, border: `2px solid ${t.border}`, borderRadius: 8, color: t.textStrong, fontFamily: ff, fontSize: 16, outline: "none", boxSizing: "border-box" }} value={scanInput} onChange={e => setScanInput(e.target.value)} onKeyDown={handleScanKeyDown} onFocus={e => e.target.style.borderColor = t.accent} onBlur={e => e.target.style.borderColor = t.border} placeholder="▸ Scan barcode" />
          {lastFeedback && <div style={S.fb(lastFeedback.color)}>{lastFeedback.msg}</div>}
        </div>
        <div style={{ padding: "0 12px 12px" }}>
          {scannedItems.length === 0 ? <div style={S.empty}>Scan your first barcode.</div> :
            <div style={{ display: "flex", flexDirection: "column", gap: 6 }}>
              {[...scannedItems].reverse().map(item => { const dn = item.wrongDealer ? lookupDealer(item.dealerCode) : null; return (
                <div key={item.id} style={{ background: item.wrongDealer ? `${t.purple}08` : t.bg2, border: `1px solid ${item.wrongDealer ? t.purple + "40" : item.dipp ? t.blue + "40" : t.border}`, borderRadius: 8, padding: "10px 12px", boxShadow: t.shadow }}>
                  <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 6 }}>
                    <div><div style={{ fontSize: 16, fontWeight: 900, color: t.textStrong }}>{item.partNumber}</div><div style={{ fontSize: 11, color: t.textMuted }}>SO: {item.shippingOrder} · PDC: {item.pdc} · <span style={S.bg(item.type === "CA" ? `${t.green}15` : `${t.blue}15`, item.type === "CA" ? t.greenText : t.blueText)}>{item.type}</span></div>{item.wrongDealer && <div style={{ fontSize: 11, color: t.purpleText, fontWeight: 700, marginTop: 2 }}>⚠ {item.dealerCode}{dn ? ` — ${dn.name}` : ""}</div>}</div>
                    <button onClick={() => { setQtyEditId(item.id); setQtyEditVal(String(item.quantity)); }} style={{ background: t.bg3, border: `1px solid ${t.border}`, borderRadius: 6, padding: "4px 10px", cursor: "pointer", fontFamily: ff, fontSize: 18, fontWeight: 900, color: t.textStrong, minWidth: 44, textAlign: "center" }}>{item.quantity}</button>
                  </div>
                  <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
                    <button style={{ padding: "6px 12px", background: item.dipp ? t.blue : t.bg3, color: item.dipp ? "#fff" : t.textMuted, border: `1px solid ${item.dipp ? t.blue : t.border}`, borderRadius: 6, fontFamily: ff, fontSize: 11, fontWeight: 600, cursor: "pointer" }} onClick={() => toggleDipp(item.id)}>{item.dipp ? "★ DIPP" : "DIPP"}</button>
                    <button style={{ padding: "6px 10px", background: t.bg3, color: t.textMuted, border: `1px solid ${t.border}`, borderRadius: 6, fontFamily: ff, fontSize: 11, cursor: "pointer" }} onClick={() => adjQty(item.id, -1)}>−</button>
                    <button style={{ padding: "6px 10px", background: t.bg3, color: t.textMuted, border: `1px solid ${t.border}`, borderRadius: 6, fontFamily: ff, fontSize: 11, cursor: "pointer" }} onClick={() => adjQty(item.id, 1)}>+</button>
                    <button style={{ padding: "6px 12px", background: t.redBg, color: t.redText, border: `1px solid ${t.red}30`, borderRadius: 6, fontFamily: ff, fontSize: 11, fontWeight: 600, cursor: "pointer", marginLeft: "auto" }} onClick={() => delScan(item.id)}>✕ Delete</button>
                  </div>
                </div>); })}
            </div>}
          {scannedItems.length > 0 && <button style={{ ...S.btn(t.redBg, t.redText), marginTop: 12, width: "100%", padding: "10px" }} onClick={() => { if (confirm("Clear ALL scans?")) { setScannedItems([]); fetch("/api/scans", { method: "DELETE" }).catch(() => {}); } }}>Clear All Scans</button>}
        </div>
      </div>
    );
  }

  // ═══ WORKSTATION MODE ══════════════════════════════════════
  return (
    <div style={{ fontFamily: ff, background: t.bg0, color: t.text, minHeight: "100vh", fontSize: 13 }}>
      {settingsModal}{wdPopup}
      {qtyEditId && <div style={S.overlay} onClick={() => setQtyEditId(null)}><div onClick={e => e.stopPropagation()} style={{ background: t.bg2, border: `1px solid ${t.border}`, borderRadius: 12, padding: 20, width: 240, textAlign: "center" }}><div style={{ fontSize: 11, color: t.textMuted, marginBottom: 8 }}>SET QUANTITY</div><input autoFocus type="number" min="1" value={qtyEditVal} onChange={e => setQtyEditVal(e.target.value)} onKeyDown={e => { if (e.key === "Enter") { setQty(qtyEditId, qtyEditVal); setQtyEditId(null); } }} style={{ width: 80, padding: 10, background: t.bgInput, border: `2px solid ${t.accent}`, borderRadius: 8, color: t.textStrong, fontFamily: ff, fontSize: 24, textAlign: "center", outline: "none" }} /><div style={{ display: "flex", gap: 8, marginTop: 12, justifyContent: "center" }}><button style={S.btn(t.bg3, t.textMuted)} onClick={() => setQtyEditId(null)}>Cancel</button><button style={S.btn(t.accent, "#fff")} onClick={() => { setQty(qtyEditId, qtyEditVal); setQtyEditId(null); }}>Set</button></div></div></div>}
      <div style={{ background: t.bg1, borderBottom: `1px solid ${t.border}`, padding: "10px 16px", display: "flex", alignItems: "center", justifyContent: "space-between", position: "sticky", top: 0, zIndex: 100, gap: 12, flexWrap: "wrap", boxShadow: t.shadow }}>
        <div style={{ display: "flex", alignItems: "center", gap: 10 }}><button style={S.sm(t.bg3, t.textMuted)} onClick={() => setAppMode(null)}>←</button><div style={{ width: 30, height: 30, background: "linear-gradient(135deg,#dc2626,#991b1b)", borderRadius: 5, display: "flex", alignItems: "center", justifyContent: "center", fontWeight: 900, fontSize: 12, color: "#fff" }}>GM</div><div><div style={{ fontSize: 14, fontWeight: 700, color: t.textStrong }}>Workstation</div><div style={{ fontSize: 10, color: t.textMuted }}>{settings.dealerName} · {settings.dealerCode}</div></div></div>
        <div style={{ display: "flex", alignItems: "center", gap: 8, flexWrap: "wrap" }}>
          <div style={{ display: "flex", gap: 4, flexWrap: "wrap" }}><span style={S.pill(t.text)}>{stats.total} scanned</span><span style={S.pill(t.text)}>{purchaseOrders.length} PO</span>{stats.wd > 0 && <span style={S.pill(t.purpleText)}>⚠{stats.wd}</span>}{stats.dipp > 0 && <span style={S.pill(t.blueText)}>D{stats.dipp}</span>}{purchaseOrders.length > 0 && <><span style={S.pill(t.greenText)}>✓{nM}</span>{nS > 0 && <span style={S.pill(t.redText)}>{nS}S</span>}{nO > 0 && <span style={S.pill(t.yellowText)}>{nO}O</span>}</>}</div>
          <button style={{ width: 30, height: 30, borderRadius: 6, border: `1px solid ${t.border}`, background: t.bg3, display: "flex", alignItems: "center", justifyContent: "center", cursor: "pointer", fontSize: 16, color: t.textMuted }} onClick={openSettings}>⚙</button>
        </div>
      </div>
      <div style={{ display: "flex", background: t.bg1, borderBottom: `1px solid ${t.border}`, position: "sticky", top: 52, zIndex: 99, overflowX: "auto" }}>
        {[["scan", "Scan", stats.total, t.textFaint], ["compare", "Compare", nS, t.red], ["wrongdealer", "Wrong Dealer", stats.wd, t.purple], ["dipp", "DIPP", stats.dipp, t.blue], ["form", "Form / Email", 0, null]].map(([k, l, n, c]) => <button key={k} style={{ padding: "9px 16px", cursor: "pointer", border: "none", background: wsTab === k ? t.bg2 : "transparent", color: wsTab === k ? t.textStrong : t.textMuted, borderBottom: wsTab === k ? `2px solid ${t.accent}` : "2px solid transparent", fontFamily: ff, fontSize: 11, fontWeight: wsTab === k ? 600 : 400, display: "flex", alignItems: "center", gap: 6, whiteSpace: "nowrap" }} onClick={() => setWsTab(k)}>{l} {n > 0 && <Bdg n={n} c={c} />}</button>)}
      </div>
      <div style={{ padding: "14px 16px", maxWidth: 1200, margin: "0 auto" }}>
        {wsTab === "scan" && (<>
          {pendingUS && <div style={{ padding: "8px 12px", background: t.yellowBg, borderBottom: `2px solid ${t.yellow}`, color: t.yellowText, fontSize: 12, fontWeight: 600, display: "flex", justifyContent: "space-between", marginBottom: 10 }}><span>⏳ US {pendingUS.type === "header" ? "part" : "header"} pending</span><button style={S.sm(`${t.yellow}20`, t.yellowText)} onClick={() => setPendingUS(null)}>Cancel</button></div>}
          <div style={S.card}><div style={{ padding: 12 }}><input ref={scanRef} autoFocus autoComplete="off" style={{ width: "100%", padding: "12px 14px", background: t.bgInput, border: `2px solid ${t.border}`, borderRadius: 6, color: t.textStrong, fontFamily: ff, fontSize: 15, outline: "none", boxSizing: "border-box" }} value={scanInput} onChange={e => setScanInput(e.target.value)} onKeyDown={handleScanKeyDown} onFocus={e => e.target.style.borderColor = t.accent} onBlur={e => e.target.style.borderColor = t.border} placeholder="▸ Scan barcode — Enter or Tab" />{lastFeedback && <div style={S.fb(lastFeedback.color)}>{lastFeedback.msg}</div>}</div></div>
          <div style={S.card}><div style={S.cH}><span style={S.cL}>Scanned · {stats.unique} unique · {stats.total} total</span>{scannedItems.length > 0 && <button style={S.sm(t.bg3, t.textMuted)} onClick={() => { if (confirm("Clear?")) setScannedItems([]) }}>Clear</button>}</div>
            {scannedItems.length === 0 ? <div style={S.empty}>No items.</div> : <div style={{ overflowX: "auto", maxHeight: 500, overflowY: "auto" }}><table style={S.tbl}><thead><tr><th style={S.th}>Part #</th><th style={S.th}>SO</th><th style={S.th}>PDC</th><th style={S.th}>Dealer</th><th style={S.th}>Qty</th><th style={S.th}>Flags</th><th style={S.th}></th></tr></thead><tbody>
              {[...scannedItems].reverse().map(item => { const dn = item.wrongDealer ? lookupDealer(item.dealerCode) : null; return (
                <tr key={item.id} style={{ background: item.wrongDealer ? `${t.purple}08` : "transparent" }}>
                  <td style={S.td(t.textStrong)}><strong>{item.partNumber}</strong></td><td style={S.td()}>{item.shippingOrder}</td><td style={S.td()}>{item.pdc}</td>
                  <td style={S.td(item.wrongDealer ? t.purpleText : null)}>{item.dealerCode}{item.wrongDealer && " ⚠"}{dn && <div style={{ fontSize: 9, color: t.purpleText }}>{dn.name}</div>}</td>
                  <td style={S.td(t.textStrong)}><span style={{ display: "flex", alignItems: "center", gap: 4 }}><button style={S.sm(t.bg3, t.textMuted)} onClick={() => adjQty(item.id, -1)}>−</button><button style={{ background: "transparent", border: "none", color: t.textStrong, fontFamily: ff, fontSize: 13, fontWeight: 700, cursor: "pointer", padding: "2px 4px" }} onClick={() => { setQtyEditId(item.id); setQtyEditVal(String(item.quantity)); }}>{item.quantity}</button><button style={S.sm(t.bg3, t.textMuted)} onClick={() => adjQty(item.id, 1)}>+</button></span></td>
                  <td style={S.td()}>{item.wrongDealer && <span style={{ ...S.bg(`${t.purple}15`, t.purpleText), marginRight: 3 }}>WD</span>}{item.dipp && <span style={S.bg(`${t.blue}15`, t.blueText)}>DIPP</span>}</td>
                  <td style={S.td()}><span style={{ display: "flex", gap: 4 }}><button style={S.sm(item.dipp ? `${t.blue}20` : t.bg3, item.dipp ? t.blueText : t.textFaint)} onClick={() => toggleDipp(item.id)}>{item.dipp ? "★" : "D"}</button><button style={S.sm(t.bg3, t.textFaint)} onClick={() => delScan(item.id)}>✕</button></span></td>
                </tr>); })}</tbody></table></div>}
          </div>
        </>)}
        {wsTab === "compare" && (<>
          <div style={S.card}><div style={S.cH}><span style={S.cL}>POs ({purchaseOrders.length})</span><label style={{ ...S.btn(t.accent, "#fff"), cursor: "pointer" }}>+ XLSX<input ref={fileInputRef} type="file" accept=".xlsx,.xls,.csv" multiple onChange={handleFileUpload} style={{ display: "none" }} /></label></div>
            {purchaseOrders.length > 0 && <div style={{ padding: "8px 12px", display: "flex", gap: 6, flexWrap: "wrap", borderBottom: `1px solid ${t.border}` }}><button style={{ padding: "5px 10px", background: activePO === "__all__" ? t.accentBg : t.bg3, border: `1px solid ${activePO === "__all__" ? t.accent : t.border}`, borderRadius: 4, cursor: "pointer", fontSize: 11, color: activePO === "__all__" ? t.accentText : t.textMuted, fontFamily: ff }} onClick={() => setActivePO("__all__")}>All</button>{purchaseOrders.map(po => <button key={po.id} style={{ padding: "5px 10px", background: activePO === po.pbsPO ? t.accentBg : t.bg3, border: `1px solid ${activePO === po.pbsPO ? t.accent : t.border}`, borderRadius: 4, cursor: "pointer", fontSize: 11, color: activePO === po.pbsPO ? t.accentText : t.textMuted, fontFamily: ff, display: "flex", alignItems: "center", gap: 6 }} onClick={() => setActivePO(po.pbsPO)}><strong>{po.pbsPO}</strong>{po.gmControl && ` · ${po.gmControl}`}<span style={S.sm("transparent", t.textFaint)} onClick={e => { e.stopPropagation(); removePO(po.id); }}>✕</span></button>)}</div>}
            <details style={{ borderTop: `1px solid ${t.border}` }}><summary style={{ padding: "8px 12px", cursor: "pointer", fontSize: 11, color: t.textMuted }}>Paste CSV</summary><div style={{ padding: 12 }}><input style={S.inp} value={csvPO} onChange={e => setCsvPO(e.target.value)} placeholder="PO Name" /><textarea style={{ width: "100%", padding: 10, background: t.bgInput, border: `1px solid ${t.border}`, borderRadius: 4, color: t.text, fontFamily: ff, fontSize: 12, minHeight: 80, resize: "vertical", boxSizing: "border-box", marginTop: 6 }} value={csvText} onChange={e => setCsvText(e.target.value)} placeholder="Paste..." /><button style={{ ...S.btn(t.accent, "#fff"), marginTop: 6 }} onClick={handleCSVPaste}>Load</button></div></details>
          </div>
          {purchaseOrders.length > 0 && (<><div style={{ display: "flex", gap: 8, marginBottom: 10, alignItems: "center" }}><span style={{ fontSize: 10, color: t.textMuted, fontWeight: 600 }}>SHIPMENT:</span><select style={S.sel} value={selectedShipment} onChange={e => setSelectedShipment(e.target.value)}><option value="all">All</option>{getShipNums().map(sn => <option key={sn} value={sn}>{sn}</option>)}</select></div>
            <div style={S.card}><div style={S.cH}><span style={S.cL}><span style={{ color: t.greenText }}>{nM}✓</span> · <span style={{ color: t.redText }}>{nS} short</span> · <span style={{ color: t.yellowText }}>{nO} over</span></span></div>
              {comp.length === 0 ? <div style={S.empty}>No results.</div> : <div style={{ overflowX: "auto", maxHeight: 500, overflowY: "auto" }}><table style={S.tbl}><thead><tr><th style={S.th}>Status</th><th style={S.th}>Part #</th><th style={S.th}>SO</th><th style={S.th}>Exp</th><th style={S.th}>Scan</th><th style={S.th}>Diff</th><th style={S.th}>Notes</th></tr></thead><tbody>
                {comp.map((r, i) => { const c = sc(r.status); return <tr key={i} style={{ background: c.row }}><td style={S.td()}><span style={S.bg(c.bg, c.tx)}>{STATUS_CFG[r.status]?.label}</span></td><td style={S.td(t.textStrong)}><strong>{r.partNumber}</strong>{r.superseded && <div style={{ fontSize: 9, color: t.yellowText }}>↳{r.partOrdered}</div>}</td><td style={S.td()}>{r.shippingOrder}</td><td style={S.td()}>{r.expectedQty}</td><td style={S.td(r.scannedQty !== r.expectedQty ? c.tx : null)}>{r.scannedQty}</td><td style={S.td(r.qtyDiff > 0 ? t.yellowText : r.qtyDiff < 0 ? t.redText : t.greenText)}>{r.qtyDiff > 0 ? "+" : ""}{r.qtyDiff}</td><td style={S.td()}>{r.wrongDealer && <span style={{ ...S.bg(`${t.purple}15`, t.purpleText), marginRight: 3 }}>WD</span>}{r.superseded && <span style={{ ...S.bg(`${t.yellow}15`, t.yellowText), marginRight: 3 }}>SUP</span>}{r.dipp && <span style={S.bg(`${t.blue}15`, t.blueText)}>D</span>}</td></tr>; })}</tbody></table></div>}</div></>)}
        </>)}
        {wsTab === "wrongdealer" && <div style={S.card}><div style={S.cH}><span style={S.cL}>Wrong Dealer ({getWD().length})</span></div>{getWD().length === 0 ? <div style={S.empty}>None.</div> : <div style={{ overflowX: "auto" }}><table style={S.tbl}><thead><tr><th style={S.th}>Part #</th><th style={S.th}>Dealer</th><th style={S.th}>Belongs To</th><th style={S.th}>Contact</th><th style={S.th}>SO</th><th style={S.th}>Qty</th></tr></thead><tbody>{getWD().map(item => { const d = lookupDealer(item.dealerCode); return <tr key={item.id}><td style={S.td(t.textStrong)}><strong>{item.partNumber}</strong></td><td style={S.td(t.purpleText)}><strong>{item.dealerCode}</strong></td><td style={S.td()}>{d ? d.name : <em style={{ color: t.textFaint }}>Unknown</em>}</td><td style={S.td()}>{d?.email ? <span>{d.contact} <span style={{ color: t.blueText }}>{d.email}</span></span> : "—"}</td><td style={S.td()}>{item.shippingOrder}</td><td style={S.td()}>{item.quantity}</td></tr>; })}</tbody></table></div>}</div>}
        {wsTab === "dipp" && <div style={S.card}><div style={S.cH}><span style={S.cL}>DIPP ({getDipp().length})</span></div>{getDipp().length === 0 ? <div style={S.empty}>None.</div> : <div style={{ overflowX: "auto" }}><table style={S.tbl}><thead><tr><th style={S.th}>Part #</th><th style={S.th}>PDC</th><th style={S.th}>SO</th><th style={S.th}>Description</th><th style={S.th}>Comments</th></tr></thead><tbody>{getDipp().map(item => <tr key={item.id}><td style={S.td(t.textStrong)}><strong>{item.partNumber}</strong></td><td style={S.td()}>{item.pdc}</td><td style={S.td()}>{item.shippingOrder}</td><td style={S.td()}><input style={{ ...S.inp, width: "100%", minWidth: 120 }} value={dippDescriptions[item.id] || ""} onChange={e => setDippDescriptions(p => ({ ...p, [item.id]: e.target.value }))} placeholder="Part description..." /></td><td style={S.td()}><input style={{ ...S.inp, width: "100%", minWidth: 140 }} value={dippComments[item.id] || ""} onChange={e => setDippComments(p => ({ ...p, [item.id]: e.target.value }))} placeholder="Damage..." /><div style={{ display: "flex", gap: 3, flexWrap: "wrap", marginTop: 4 }}>{DIPP_PRESETS.map(p => <button key={p} style={S.sm(t.bg3, t.textMuted)} onClick={() => setDippComments(prev => ({ ...prev, [item.id]: (prev[item.id] || "") + (prev[item.id] ? ", " : "") + p }))}>{p}</button>)}</div></td></tr>)}</tbody></table></div>}</div>}
        {wsTab === "form" && (<>
          <div style={S.card}>
            <div style={S.cH}><span style={S.cL}>Woodstock Form</span></div>
            <div style={{ padding: 12, borderBottom: `1px solid ${t.border}` }}><div style={{ display: "flex", gap: 10, flexWrap: "wrap" }}><div><label style={S.lbl}>Completed By</label><input style={S.inp} value={completedBy} onChange={e => setCompletedBy(e.target.value)} placeholder="Name" /></div><div><label style={S.lbl}>Date</label><input style={S.inp} type="date" value={formDate} onChange={e => setFormDate(e.target.value)} /></div><div><label style={S.lbl}>Phone</label><input style={{ ...S.inp, color: t.textFaint }} value={settings.phone} readOnly /></div>{purchaseOrders.length > 1 && <div><label style={S.lbl}>PO</label><select style={S.sel} value={activePO || ""} onChange={e => setActivePO(e.target.value)}><option value="__all__">All</option>{purchaseOrders.map(po => <option key={po.id} value={po.pbsPO}>{po.pbsPO}</option>)}</select></div>}</div></div>
            <div style={{ display: "flex", gap: 8, padding: 12, background: t.bg3, flexWrap: "wrap", alignItems: "center" }}>
              <button style={{ padding: "8px 16px", background: t.accent, color: "#fff", border: "none", borderRadius: 6, fontFamily: ff, fontSize: 12, fontWeight: 600, cursor: "pointer" }} onClick={generatePDFHandler} disabled={pdfGenerating}>{pdfGenerating ? "⏳..." : "⬇ Generate PDF"}</button>
              {lastPdfBlob && <><button style={{ padding: "8px 16px", background: t.bg2, color: t.text, border: `1px solid ${t.border}`, borderRadius: 6, fontFamily: ff, fontSize: 12, fontWeight: 600, cursor: "pointer" }} onClick={printPDF}>🖨 Print</button><button style={{ padding: "8px 16px", background: "#0078d4", color: "#fff", border: "none", borderRadius: 6, fontFamily: ff, fontSize: 12, fontWeight: 600, cursor: "pointer" }} onClick={emailOutlook}>✉ Outlook</button></>}
              {lastPdfBlob && <span style={{ fontSize: 10, color: t.greenText, fontWeight: 600 }}>✓ {lastPdfName}</span>}
            </div>
            {lastPdfBlob && <div style={{ padding: 12, borderTop: `1px solid ${t.border}` }}><div style={{ background: t.bg0, border: `1px solid ${t.border}`, borderRadius: 6, padding: 12, fontSize: 12 }}><div style={{ marginBottom: 4 }}><span style={{ color: t.textMuted }}>To: </span>{settings.wdkEmail}</div>{getCCStr() && <div style={{ marginBottom: 4 }}><span style={{ color: t.textMuted }}>CC: </span><span style={{ color: t.blueText }}>{getCCStr()}</span></div>}<div style={{ marginBottom: 4 }}><span style={{ color: t.textMuted }}>Subject: </span><strong>{emailSubject}</strong></div><div><span style={{ color: t.textMuted }}>Attach: </span><span style={{ color: t.greenText }}>📎 {lastPdfName}</span></div></div></div>}
            <div style={{ padding: 12, display: "flex", gap: 20, flexWrap: "wrap", borderTop: `1px solid ${t.border}` }}>{[["Shorts", nS, t.red], ["WD", stats.wd, t.purple], ["DIPP", stats.dipp, t.blue], ["Over", nO, t.yellow], ["Match", nM, t.green]].map(([l, n, c]) => <div key={l} style={{ display: "flex", alignItems: "center", gap: 6 }}><span style={{ ...S.dot(c) }}></span><span style={{ fontSize: 12, color: t.textMuted }}>{l}:</span><strong style={{ color: c }}>{n}</strong></div>)}</div>
          </div>
        </>)}
      </div>
    </div>
  );
}
